---
# tasks file for kde_fonts

- name: Ensure KDE config directory exists
  ansible.builtin.file:
    path: "{{ kde_fonts_user_home }}/.config"
    state: directory
    owner: "{{ kde_fonts_user }}"
    group: "{{ kde_fonts_user }}"
    mode: '0755'
  tags:
    - kde_fonts
    - kde
    - fonts
    - configuration

- name: Set KDE general font (Fira Sans)
  community.general.ini_file:
    path: "{{ kde_fonts_user_home }}/.config/kdeglobals"
    section: General
    option: font
    value: "{{ kde_font_general }}"
    owner: "{{ kde_fonts_user }}"
    group: "{{ kde_fonts_user }}"
    mode: '0644'
    no_extra_spaces: true
  tags:
    - kde_fonts
    - kde
    - fonts
    - configuration

- name: Set KDE fixed-width font (JetBrainsMono Nerd Font Mono)
  community.general.ini_file:
    path: "{{ kde_fonts_user_home }}/.config/kdeglobals"
    section: General
    option: fixed
    value: "{{ kde_font_fixed }}"
    owner: "{{ kde_fonts_user }}"
    group: "{{ kde_fonts_user }}"
    mode: '0644'
    no_extra_spaces: true
  tags:
    - kde_fonts
    - kde
    - fonts
    - configuration

- name: Set KDE smallest readable font
  community.general.ini_file:
    path: "{{ kde_fonts_user_home }}/.config/kdeglobals"
    section: General
    option: smallestReadableFont
    value: "{{ kde_font_small }}"
    owner: "{{ kde_fonts_user }}"
    group: "{{ kde_fonts_user }}"
    mode: '0644'
    no_extra_spaces: true
  tags:
    - kde_fonts
    - kde
    - fonts
    - configuration

- name: Set KDE toolbar font
  community.general.ini_file:
    path: "{{ kde_fonts_user_home }}/.config/kdeglobals"
    section: General
    option: toolBarFont
    value: "{{ kde_font_toolbar }}"
    owner: "{{ kde_fonts_user }}"
    group: "{{ kde_fonts_user }}"
    mode: '0644'
    no_extra_spaces: true
  tags:
    - kde_fonts
    - kde
    - fonts
    - configuration

- name: Set KDE menu font
  community.general.ini_file:
    path: "{{ kde_fonts_user_home }}/.config/kdeglobals"
    section: General
    option: menuFont
    value: "{{ kde_font_menu }}"
    owner: "{{ kde_fonts_user }}"
    group: "{{ kde_fonts_user }}"
    mode: '0644'
    no_extra_spaces: true
  tags:
    - kde_fonts
    - kde
    - fonts
    - configuration

- name: Set KDE active font
  community.general.ini_file:
    path: "{{ kde_fonts_user_home }}/.config/kdeglobals"
    section: General
    option: activeFont
    value: "{{ kde_font_active }}"
    owner: "{{ kde_fonts_user }}"
    group: "{{ kde_fonts_user }}"
    mode: '0644'
    no_extra_spaces: true
  tags:
    - kde_fonts
    - kde
    - fonts
    - configuration

- name: Display KDE fonts configuration info
  ansible.builtin.debug:
    msg: |
      KDE fonts have been configured successfully!

      Font Settings:
      - General/UI Font: Fira Sans 10
      - Fixed-width Font: JetBrainsMono Nerd Font Mono 10
      - Configuration file: {{ kde_fonts_user_home }}/.config/kdeglobals

      Next Steps:
      1. Log out and log back in for changes to take full effect
      2. Alternatively, restart KDE Plasma:
         - Press Alt+F2 and run: kquitapp5 plasmashell && kstart5 plasmashell
         - Or simply log out and back in

      Note: If fonts don't appear correctly, verify the fonts are installed:
      - fc-list | grep "Fira Sans"
      - fc-list | grep "JetBrainsMono Nerd Font"
  tags:
    - kde_fonts
    - kde
    - fonts
    - configuration
